<?xml version="1.0"?>
<document>
  <id>2238971</id>
  <title>PairsDB atlas of protein sequence space
</title>
  <abstract>
 Sequence similarity/database searching is a cornerstone of molecular biology. PairsDB is a database intended to make exploring protein sequences and their similarity relationships quick and easy. Behind PairsDB is a comprehensive collection of protein sequences and BLAST and PSI-BLAST alignments between them. Instead of running BLAST or PSI-BLAST individually on each request, results are retrieved instantaneously from a database of pre-computed alignments. Filtering options allow you to find a set of sequences satisfying a set of criteria&#x2014;for example, all human proteins with solved structure and without transmembrane segments. PairsDB is continually updated and covers all sequences in Uniprot. The data is stored in a MySQL relational database. Data files will be made available for download at ftp://nic.funet.fi/pub/sci/molbio. PairsDB can also be accessed interactively at http://pairsdb.csc.fi. PairsDB data is a valuable platform to build various downstream automated analysis pipelines. For example, the graph of all-against-all similarity relationships is the starting point for clustering protein families, delineating domains, improving alignment accuracy by consistency measures, and defining orthologous genes. Moreover, query-anchored stacked sequence alignments, profiles and consensus sequences are useful in studies of sequence conservation patterns for clues about possible functional sites.
</abstract>
  <content>
 Proteins are major constituents of all cells and central to our understanding of molecular biology. The past and present genome projects have provided us with an exponentially growing wealth of protein sequences from many diverse organisms. However, this wealth creates a new problem. The majority of protein sequences have not been studied experimentally in the laboratory and our first-hand knowledge about them is minimal. Inferring functions of protein sequences is a major challenge in bioinformatics. The function of a novel protein sequence can often be inferred by studying similar protein sequences in other organisms. Just as whole organisms are related to each other by evolutionary descent, so are the proteins between organisms related by inheritance and mutation. Protein sequences in different organisms sharing an ancestral protein sequence are believed to fulfil the same function and are said to belong to the same protein family. Common ancestry between protein sequences is commonly established by studying protein similarity. During evolution, protein sequences accumulate mutations, but parts of the protein, which are central to its function will remain conserved due to selection. These conserved parts give rise to a detectable similarity between related sequences. Wall-clock timings for query BRCA1_HUMAN Wall-clock timings for query BRCA1_HUMAN PairsDB is a relational database of sequence relationships. It contains a comprehensive collection of protein sequences and BLAST and PSI-BLAST alignments between them. PairsDB is built in six steps: (i) collection of protein sequences, (ii) sequence annotation, (iii) redundancy removal at 90% identity, (iv) BLAST all-on-all alignment, (v) creation of non-redundant sequence subsets and (vi) PSI-BLAST all-on-all alignments. Details follow. PairsDB is constructed by retrieving peptide sequences from a variety of publicly available databases. The current sequence data set of PairsDB was collected from the following datasets: UniProt (http://www.ebi.ac.uk/uniprot), PDB Protein Databank (http://www.pdb.org), ENSEMBL (http://www.ensembl.org) and RefSeq (http://www.ncbi.nlm.nih.gov/RefSeq). Cross-references to the source database are stored for each sequence entry in PairsDB. The peptide sequences are collated into a single input set. Identical sequences are merged into a single entry, which has a stable, unique identifier. The set of unique sequences is called NRDB (alias NRDB100). Composition-biased regions (2) are detected by an in-house perl script written by G. Casari. Transmembrane segments are detected by tmhmm (Version 1.1) (3). Coiled coils are detected using Coils (Version 2.1) (4). Short repeats are identified using an in-house perl script. Data on domain family membership of a sequence entry is imported from ADDA (5), CATH (6), InterPro (7) and SCOP (8). Domain information is further mapped at the residue level to the representative sequences in the NRDB90 and NRDB40 sets described below. Hypothetical proteins, fragments and sequences from completely sequenced genomes are flagged. The input set is pruned of highly redundant sequences using the nrdb90 method (9) as implemented by CD-HIT (10). This method begins by sorting all sequences by length in decreasing order. Starting from the longest sequence (representative sequence), the procedure removes all sequences from the set that align over their full length and are more than 90% identical to the selected sequence. The procedure then takes the second longest sequence and does the same. The procedure continues, until all sequences have been processed. The remaining set constitutes a set of representative sequences at 90% sequence identity, NRDB90. Because of the high similarity threshold, most alignments need not be calculated explicitly, but instead a fast tuple lookup algorithm is sufficient. The CD-HIT program was run with the following parameters: -M 2000 (memory/Mb) -n 5 (word length) -c 0.90 (sequence identity threshold) -d 40 (length of description line). For all sequences in the representative set NRDB90, we run BLASTP in an all-on-all fashion. We use NCBI BLAST (Version 2.28) with the following parameters: -e 1.0 (maximum reported e-value) -z 65 000 000 (effective database size) -b 100 000 (alignments reported) -v 100 000 (hits reported) -F F (seg filtering off). Sequences submitted to BLAST are masked by composition bias, transmembrane regions, coiled coils and short repeats. The alignments are stored in a relational database. Using the alignment results from the previous steps, we produce a set of nested non-redundant sequence subsets for 80%, 70%, 60%, 50%, 40% and 30% sequence identity (11). These are called, synonymously, RSDBxx or NRDBxx, where xx is the level of sequence identity. The procedure works similarly to the creation of NRDB90, but percent identity is now retrieved from the BLAST results stored in the relational database. We run PSI-BLAST for all sequences in the representative set NRDB40 in an all-on-all fashion. We use NCBI PSI-BLAST (Version 2.28) program blastpgp with the following parameters: -j 10 (number of iterations) -e 1 (maximum e-value of reported hits) -h 0.001 (inclusion threshold) -v 100 000 (hits reported) -b 100 000 (alignments reported). Sequences submitted to PSI-BLAST are masked by composition bias, coiled coils and short repeats. The results are stored in a relational database. (a) Data storage model and (b) Functionality of the PairsDB web server. (a) Data storage model and (b) Functionality of the PairsDB web server. The web server supports four types of query: (i) SeqInfo allows you to view all information about a particular protein sequence of interest from the PairsDB database; (ii) BLAST allows you to find BLAST matches for a sequence; (iii) PSI-BLAST allows you to find PSI-BLAST matches for a sequence; (iv) Seq Space Filter allows you to find a set of sequences satisfying a set of criteria. On each result page, shortcuts &#x2018;I B P&#x2019; next to a match take you to the SeqInfo, BLAST, and PSI-BLAST views, respectively, of that sequence. BLAST and PSI-BLAST results are shown as a match list (with graphical overview, similarity score and sequence description) and in stacked or pairwise alignment views (Figure 1b). The stacked alignment representation was popularized by HSSP (12) and is also used for example to generate profiles in PSI-BLAST (1). Stacked alignments show matching sequences underneath the query sequence, omitting insertions in the matching sequence. Pairwise alignments show the entire peptide sequence of both parties. PSI-BLAST, especially, can produce match lists with thousands of neighbours. Therefore it is an important feature of PairsDB that the match list can be filtered based on sequence features, species, and family classifications, and truncated at an e-value threshold. In order to enable the integration of PairsDB to other applications and workflow tools such as Taverna (http://taverna.sourceforge.net/), we are currently developing a SOAP Web service interface for it. Further information including the description document in WSDL (Web service description language) will be available on the PairsDB web site. Below, we describe two utility scripts, which use a local copy of the PairsDB database in MySQL. The scripts are available on request. The list of options in expand_pairsdb.pl is illustrated in Supplementary Figure 1b. PairsDB data tables are of two types: (i) attributes (features, flags) of individual sequences, and (ii) alignments between two sequences. Alignments are divided to two parts: the alignments/mappings of all sequences to the representative subset, and the alignments between all representatives (Figure 1a). Sequence attributes are used for filtering the match list, while a little additional computation is required to generate transitive alignments, query-anchored stacked alignments in various formats, profiles and consensus sequences. PairsDB data covers only sequences already in Uniprot, PDB, Ensembl or Refseq. New sequences not yet in the source databases need to be mapped to a sequence known to PairsDB. A second utility script, called pairsdb_mapper.pl, identifies the nearest neighbour of a query sequence, which can be given as database identifier, accession number, amino acid sequence or domain range (Supplementary Figure 2). Multiple queries can be given in a fasta-file or list of fasta-files. The script uses a hash-code lookup to identify identical amino acid sequences, while a suffix array search recognizes identical fragments; if these fail to find a match, a BLAST run is performed. The user can substitute these mappings for the default PairsDB table in expand_pairsdb.pl. We currently update PairsDB 1&#x2013;2 times per year. We are planning to move a weekly incremental update cycle for the BLAST all-on-all comparisons, with a less frequent update cycle for PSI-BLAST searches, which must start from scratch. The data is stored in a MySQL relational database. Data files will be made available for download at ftp://nic.funet.fi/pub/sci/molbio. Our latest database contains 3.4 M unique protein sequences. After removing trivially similar sequences, we obtain 2.0 M and 1.1 M representative protein sequences in NRDB90 and NRDB40, respectively. The all versus all comparison yields 4.5 G and 2.3 G similarity relationships in the all-on-all comparison of NRDB90 by BLAST and of NRDB40 by PSI-BLAST, respectively. The PairsDB web server allows these similarity relationships to be explored online and interactively (Figure 1b). Large-scale analyses should work on a local copy of the database. To avoid excessively long and redundant match lists, we generally recommend searching against NRDB90 (default for BLAST results) or NRDB40 (default for PSI-BLAST results). These results are typically retrieved in a few seconds, compared to many minutes if the search is re-run with BLAST or PSI-BLAST (Table 1). Similarity searches are often done to infer the function of hypothetical proteins based on what is known about their nearest neighbours. For example, restricting the source database to PDB retrieves possible fold assignments for a query (using the &#x2018;PSI/BLAST results expanded to NRDB100&#x2019; form on the PSI/BLAST query pages). Thus, you can see by just one click that the structural coverage of BRCA1_HUMAN spans an N-terminal ring domain and a C-terminal BRCT domain. Molecular biologists are nowadays trained to do bioinformatics using web servers. PairsDB can substitute for BLAST or PSI-BLAST servers (such as NCBI's and EBI's) when the query sequence has been already deposited in a sequence database. Based on pre-computed results, our web server has a faster response time (Table 1). The Blink (BLAST link) service of NCBI Entrez has had a similar BLAST neighbour lookup since many years. An added value of PairsDB is that it can report more distant neighbours detected by PSI-BLAST and display query-anchored stacked alignments. The stacked alignment views are useful to get a picture of which residues are conserved in a family and thereby might be targeted in functional studies. Many domain family classifications also provide multiple sequence alignments [e.g. ADDA (13), CDD (14), PFAM (15)], but PairsDB has flexible filtering options to focus on matches to proteins of interest for a particular study. PairsDB shows the &#x2018;raw&#x2019; similarity data without enforcing any particular classification of the sequences. This can actually be beneficial in allowing the user to critically evaluate electronically inferred functional annotations of suspect cases. Computational biologists can build derivative tools exploiting PairsDB data. For example, a simple BLAST or PSI-BLAST search reveals only the radial distance of neighbouring sequences from the query sequence, whereas all-on-all similarity data reveals the topology of protein sequence space and clusters of biologically related sequences are seen more clearly (16&#x2013;17). We have used the all-on-all similarity data to define protein families by a graph clustering method, ADDA. Considering all protein sequences for the clustering allows us to merge nearest neighbours hierarchically and to count exhaustively (5). A novel breed of sequence alignment methods take a library of pairwise alignments as input and use consistency criteria to suppress noise (18&#x2013;22). We have developed methods based on this data that perform sensitive alignment between very distantly related protein sequences by taking into account intermediate sequences. Even when there is no direct alignment with PSI-BLAST, our method constructs a meaningful alignment (18&#x2013;19). Furthermore, we have demonstrated how the data can be used to find functionally important parts in protein sequences that are conserved between all or a subset of members in a protein family (23&#x2013;24). Finally, reciprocal best BLAST hits are conveniently extracted from PairsDB and can be used to determine orthologous genes in completely sequenced genomes in the hope of more accurate function assignment (25). We expect that the SOAP interface will lead to a proliferation of applications and web servers exploiting PairsDB data. Supplementary Data are available at NAR Online.
</content>
</document>
