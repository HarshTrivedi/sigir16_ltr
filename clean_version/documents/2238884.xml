<?xml version="1.0"?>
<document>
  <id>2238884</id>
  <title>X:Map: annotation and visualization of genome structure for Affymetrix exon array analysis
</title>
  <abstract>
 Affymetrix exon arrays aim to target every known and predicted exon in the human, mouse or rat genomes, and have reporters that extend beyond protein coding regions to other areas of the transcribed genome. This combination of increased coverage and precision is important because a substantial proportion of protein coding genes are predicted to be alternatively spliced, and because many non-coding genes are known also to be of biological significance. In order to fully exploit these arrays, it is necessary to associate each reporter on the array with the features of the genome it is targeting, and to relate these to gene and genome structure. X:Map is a genome annotation database that provides this information. Data can be browsed using a novel Google-maps based interface, and analysed and further visualized through an associated BioConductor package. The database can be found at http://xmap.picr.man.ac.uk.
</abstract>
  <content>
 Approximately 50% of human genes are predicted to be alternately spliced (1,2), and up to 90% of the entire genome to be transcribed (3,4). Recent work has shown that many non-coding genes are of direct functional significance, that there is strong conservation in regions once characterized as simply &#x2018;junk&#x2019; DNA, and that there are many putative novel exons and transcripts in relatively well-characterized protein coding regions (4,5). Many loci also contain multiple interwoven and overlapping genes, possibly translated in different reading frames, adding additional layers of complexity (5). Together, these issues raise a number of challenges for gene expression studies. In particular, it is desirable both to use multiple reporters for individual genes in order to pursue splicing events and to increase coverage to explore the less well-characterized regions of the genome. As knowledge of the complexities of gene expression increases, so does the demand for increasingly feature-dense arrays. Advances in microarray technology are beginning to address these issues by offering significantly increased feature densities and a concomitant rise in the number of available reporters. The Affymetrix Human Exon 1.0ST array, for example uses &#x223C;6.5 million probes, comprising &#x223C;1.4 million probesets, to target &#x223C;1.2 million individual exons, and similar arrays exist for mouse and rat. The aim is to target every known and predicted exon in the genome (6&#x2013;8). These arrays offer a number of opportunities, but place significant challenges on the bioinformatics tools necessary to exploit them. In particular, sufficient annotation must be provided, for example to identify which exons, transcripts and genes are targeted by each probeset, and the levels of evidence used to define each of these features within the genome (7). The X:Map genome browser. (a) Scrollable genome map. (b) Toolbar. (c) Hierarchical annotation of map features. (d) Context-dependent annotation. The X:Map genome browser. (a) Scrollable genome map. (b) Toolbar. (c) Hierarchical annotation of map features. (d) Context-dependent annotation. An associated BioConductor (9) package, &#x2018;exonmap&#x2019; (7), provides an interface between the database and R, a popular programming language for data analysis. X:Map is unique because although some of these data are provided by, for example, Affymetrix through their NetAffx (10) database, comprehensive mappings to the genome, filtering for match specificity and provision of the data in a form that supports both high-throughput and gene-centric analysis, are not available in an integrated form elsewhere. X:Map is built by searching, in silico, every 25-mer probe sequence represented on the microarray against the entire genome [downloaded from Ensembl (11)] and recording the location of each exact match in a relational database. The search strategy is discussed in ref. (12). Genome searches are performed because many of the probesets on the array target less well-characterized regions [e.g. GenScan (13) predictions], and because the large amount of &#x2018;intergenic&#x2019; transcription observed means that it is necessary to consider each probe's potential to hybridize outside annotated genes. This is discussed further below. An additional search is also performed against a database of known transcript sequences (Ensembl cDNA data) to identify probes that cross exon boundaries; these would not be found at the genome level. This is all done via a series of Groovy (groovy.codehause.org) scripts initiated from a master Java process. Groovy was used because it allowed a much faster turnaround during prototyping and testing, while maintaining reasonable performance (Groovy scripts are compiled to Java before they are executed). The X:Map build process. (a) Overview. The entire human genome is searched against the array's 25-mer probe sequences by the Java Matching engine. Results are stored in a relational database as a set of additional tables accompanying a local installation of Ensembl. The database is used both by an R client that supports analysis using BioConductor and a webserver that supports a Web 2.0/AJAX Genome Browser. The browser serves a set of pre-computed images generated offline by a coarse-grained parallel task (b). (b) Distributed computation of image tiles using JavaSpaces. Tile generation jobs are placed in a JavaSpace by a master process (Main Java Process). These are consumed by a series of worker processes distributed across a variety of Linux machines. All image data are written to a shared network drive. The X:Map build process. (a) Overview. The entire human genome is searched against the array's 25-mer probe sequences by the Java Matching engine. Results are stored in a relational database as a set of additional tables accompanying a local installation of Ensembl. The database is used both by an R client that supports analysis using BioConductor and a webserver that supports a Web 2.0/AJAX Genome Browser. The browser serves a set of pre-computed images generated offline by a coarse-grained parallel task (b). (b) Distributed computation of image tiles using JavaSpaces. Tile generation jobs are placed in a JavaSpace by a master process (Main Java Process). These are consumed by a series of worker processes distributed across a variety of Linux machines. All image data are written to a shared network drive. The X:Map genome browser makes use of pre-drawn tiled images in order to improve run-time speed. These are generated in a second phase, managed as a coarse-grained parallel task distributed across a number of Linux servers and workstations (Figure 2b) using a producer/consumer model. In this way, spare cycles available within existing hardware are exploited. During this phase of the build, images are generated using a disparate set of 11 Linux servers and workstations in &#x223C;3 days. Tiles are then processed to generate three alternate levels of magnification (&#x223C;5 days). In the end, for all three species, layers and zoom levels, this process generates 52 GB of image data, comprising 10.27 million individual image tiles. The original Exon array annotation supplied by Affymetrix grouped probesets into three sets based on the reliability of the annotation used to define the putative genomic regions of interest. X:Map groups probesets based on Ensembl annotations, and currently provides data for Ensembl Genes, Ensembl ESTs (predictions based on EST data) and GenScan predictions (11). In this way, a direct mapping is formed between the probesets and the data sources used to provide the annotations found at the location the probeset matches the genome. The arrays use a set of short 25-mer probes to target each feature of interest, together referred to as a &#x2018;probeset&#x2019;. The majority of exon array probesets contain four probes. Each vertical line in the background of Figure 1a represents a probe. It is coloured green if that sequence can match the genome in only one location, grey if it matches at more than one site. X:Map considers a probeset to be &#x2018;multi-targeting&#x2019; if one or more of its probes matches at multiple genomic locations. X:Map also categorizes probesets according to whether they hit within an exon (&#x2018;exonic&#x2019;), within a gene but outside an exon (&#x2018;intronic&#x2019;) or between genes (&#x2018;intergenic&#x2019;). Relative proportions of probesets in different categories for Human, Mouse and Exon arrays Data were filtered to remove multi-target probesets and then matched against Ensembl genes. Intronic and intergenic probesets were then searched against Ensembl ESTs and Genscan predictions to assign matches to putative exons. Data were filtered to remove multi-target probesets and then matched against Ensembl genes. Intronic and intergenic probesets were then searched against Ensembl ESTs and Genscan predictions to assign matches to putative exons. X:Map supports a novel genome browser (Figure 1). One of the issues of presenting genomic data is the need to represent structures such as genes that are many thousands of residues long, while being able also to represent other features, such as a probe hybridization location that are a few (25 bp) residues in length. This requires a browser that can not only offer a variety of different zoom levels but can also support swift navigation up- and downstream of the current location. Other important considerations are the need to maximize the amount of screen real estate available to present data, the potential for clutter if too many features are presented at the same time and a simple but capable search interface. X:Map, which is designed specifically for high-density microarrays was required to show for each gene, transcript and exon the probesets that match it, their specificity and for each probe, their locations of potential hybridization, and for each individual exon, its sequence. These requirements were addressed by using a visual map with multiple levels of zoom. In order to maximize the responsiveness of the browser this is implemented by generating a set of pre-drawn images (for the entire genome) at various levels of magnification. These are then stored on the server as a series of small, tiled, image files, which are managed by the client using the Google Maps API, which handles the task of requesting the appropriate tiles from the server, of assembling them into a larger contiguous image, as well as the scrolling and zooming of the map. Consequently, no computation is required to generate images at run-time. The result is a fully interactive map that can be scrolled dynamically, and with a user interface that, through the use of the Google Maps API, will be already familiar to many users. In order to maximize the amount of data that can be displayed, the genome is drawn horizontally (most monitors are wider than they are tall) and extends the full width of the browser window. Data are presented as a set of transparent layers that can be added or removed from the image. By default, only the Ensembl Gene layer is shown; EST and GenScan predictions can be overlaid as required. Clearly, since the Ensembl annotation pipeline also makes use of ESTs and in silico predictions, there is a significant degree of overlap between these data, and statistical analyses using exonmap (see below) should take this non-independence into account. The tools menu (Figure 1b) can be hidden or shown by clicking on its tab. When a region of the map is selected, neighbouring features are listed in a selection box; selection from which causes information pertaining to that item to be displayed as a tree (Figure 1c). If the menu is hidden, the tab is animated (it briefly moves left and right a few pixels) providing a visual cue to draw attention to the fact that its state has changed. The hierarchy (Figure 1c) shows the nested relationships between genes, transcripts, exons, probesets, probes and their match locations. Selecting an item in the hierarchy causes contextual annotation to be displayed (Figure 1d) along with hyperlinks to external databases. Thus genes and transcripts are annotated with HUGO symbols, descriptions and hyperlinks to external databases such as Ensembl and GeneCards (14), exons with their reading frame and the appropriate fragment of genomic sequence, and probes and probesets with probe sequences and links to NetAffx (10). Icons are used to identify probesets that are annotated as non-specific, exonic, intronic and intergenic, both in the hierarchy and the annotation view. Detailed descriptions of the different icons and visual cues used within the browser can be found on the help pages accompanying the web site. Genes selected as alternatively spliced between MCF7 and MCF10A cell lines, coloured by fold change. Each row corresponds to a gene, each rectangle, an exon. Exons are arranged in position order. Exons targeted by multiple probesets are drawn with these stacked horizontally within the exon. White rectangles correspond to exons with missing data. Fold change colouring ranges from 2&#x2212;5 (intense blue; up in MCF7) to 25 (intense red; up in MCF10A). Microarray expression data mapped to the gene structure for LAMA3. (a) Two known isoforms are represented in Ensembl. Expression data are mapped onto these and coloured according to fold change between MCF7 and MCF10A. The pattern of expression across the length of the gene clearly corresponds to the known gene structure. (b) Line plot for the same data. Microarray expression data mapped to the gene structure for LAMA3. (a) Two known isoforms are represented in Ensembl. Expression data are mapped onto these and coloured according to fold change between MCF7 and MCF10A. The pattern of expression across the length of the gene clearly corresponds to the known gene structure. (b) Line plot for the same data. A possible workflow for data analysis using X:Map and exonmap is to first identify a set of differentially expressed probesets. This can be done using standard techniques developed for conventional microarrays. These are then mapped, using X:Map, to their target genes, and filtered for non-specificity due to multiple targeting. The result is a list of genes for which at least one probeset is differentially expressed. Then, for each of these genes, it is possible to retrieve expression data for every targeting probeset. Fold change (e.g. splicing index), ANOVA (e.g. MIDAS) or variance-based approaches can then be used to characterize genes according to consistency in differential expression across their length (15,16). Figure 3, for example, was generated by using limma (17) to identify all probesets with statistically significant differential expression in a triplicate comparison between two cell lines, the human breast cancer cell line MCF7, and the non-tumorigenic breast epithelial cell line, MCF10A (N = 90 051; fold change threshold &gt;2; adjusted P value = 0.05, Benjamini and Hochberg correction). This list was then filtered to remove multi-target probesets and those that did not map cleanly to exons (N = 49 326). Variance was calculated for each gene, and used to select the 200 most varying up- and downregulated genes. The dataset is described in detail in ref. (6). Gene expression can also be mapped to the transcript structure of individual genes. Figure 4a shows, for example, the gene LAMA3, with expression mapped to its transcript structure. A set of exons at the 3&#x2032; end of the gene appear differentially expressed with respect to the rest of the gene. This corresponds in location to a known short isoform. Figure 4b shows mean intensity for MCF7 and MCF10A plotted for the same gene against sequence position. It can be seen that the expression levels for both cell lines are similar at the 5&#x2032; end, but that expression levels increase in MCF10A at the 3&#x2032; end (rather than decreasing for MCF7). This provides strong evidence that the changes observed are due to over-expression of the known short isoform in MCF10A, rather than &#x2018;under-expression&#x2019; of the 5&#x2032; end of the gene in MCF7. Currently, X:Map focuses on Affymetrix Exon arrays, however, many of the approaches can be generalized to other array types, and in particular, to tiling and SNP arrays. We intend to add these array types to X:Map, and also to extend the types of annotation represented within the database to include data types more pertinent for these arrays. An advantage of the approach taken by X:Map is that, since all visualization data are pre-computed, making more annotation available via the web-interface will not result in a loss of run-time performance. We are also exploring the possibility of adding an additional client-rendered layer to allow dynamic presentation of users&#x2019; own expression data alongside the existing map annotation. All database data can be downloaded from the X:Map website, exonmap from the BioConductor website and the MCF7 and MCF10A sample data from ref. (6).
</content>
</document>
